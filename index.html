<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Viva Sabor - Bem-estar para Idosos</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap');
        
        body {
            font-family: 'Inter', sans-serif;
        }
        
        .fade-in {
            animation: fadeIn 0.5s ease-in;
        }
        
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        .modal {
            display: none;
            position: fixed;
            z-index: 1000;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0,0,0,0.5);
        }
        
        .modal.show {
            display: flex;
            align-items: center;
            justify-content: center;
        }
        
        .gradient-bg {
            background: linear-gradient(135deg, #608041 0%, #33160e 100%);
        }
        
        .card-hover {
            transition: all 0.3s ease;
        }
        
        .card-hover:hover {
            transform: translateY(-5px);
            box-shadow: 0 20px 25px -5px rgba(0, 0, 0, 0.1);
        }
    </style>
</head>
<body class="bg-gray-50">
    <!-- Tela de Login -->
    <div id="loginScreen" class="min-h-screen gradient-bg flex items-center justify-center p-4">
        <div class="bg-white rounded-2xl shadow-2xl p-8 w-full max-w-md fade-in">
            <div class="text-center mb-8">
                <img src="https://i.ibb.co/VW9XDYrJ/logo.png" alt="Viva Sabor" class="mx-auto mb-4 h-20 w-auto">
                <h1 class="text-3xl font-bold text-gray-800 mb-2">Viva Sabor</h1>
                <p class="text-gray-600">Bem-estar para a popula√ß√£o idosa</p>
            </div>
            
            <form id="loginForm" class="space-y-6">
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-2">E-mail</label>
                    <input type="email" id="loginEmail" required class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent">
                </div>
                
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-2">Senha</label>
                    <input type="password" id="loginPassword" required class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent">
                </div>
                
                <button type="submit" class="w-full bg-[#608041] hover:bg-[#33160e] text-white font-semibold py-3 px-4 rounded-lg transition duration-300">
                    Entrar
                </button>
                
                <div class="text-center">
                    <button type="button" onclick="showForgotPassword()" class="text-[#cb8b32] hover:text-[#33160e] text-sm">
                        Esqueci minha senha
                    </button>
                </div>
            </form>
        </div>
    </div>

    <!-- Tela de Primeiro Acesso -->
    <div id="firstAccessScreen" class="min-h-screen bg-gray-50 p-4 hidden">
        <div class="max-w-2xl mx-auto bg-white rounded-2xl shadow-lg p-8 fade-in">
            <h2 class="text-2xl font-bold text-gray-800 mb-6 text-center">Complete seu Perfil</h2>
            
            <form id="firstAccessForm" class="space-y-6">
                <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">Nome Completo</label>
                        <input type="text" id="fullName" required class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500">
                    </div>
                    
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">Data de Nascimento</label>
                        <input type="date" id="birthDate" required class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500">
                    </div>
                    
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">Telefone</label>
                        <input type="tel" id="phone" required class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500">
                    </div>
                    
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">Peso (kg)</label>
                        <input type="number" id="weight" required class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500">
                    </div>
                    
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">Altura (cm)</label>
                        <input type="number" id="height" required class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500">
                    </div>
                    
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">Nova Senha (6 d√≠gitos)</label>
                        <input type="password" id="newPassword" pattern="[0-9]{6}" maxlength="6" required class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-[#608041]">
                    </div>
                </div>
                
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-4">Restri√ß√µes Alimentares</label>
                    <div class="grid grid-cols-2 md:grid-cols-3 gap-3">
                        <label class="flex items-center">
                            <input type="checkbox" value="diabetes" class="restriction-checkbox mr-2">
                            <span class="text-sm">Diabetes</span>
                        </label>
                        <label class="flex items-center">
                            <input type="checkbox" value="hipertensao" class="restriction-checkbox mr-2">
                            <span class="text-sm">Hipertens√£o</span>
                        </label>
                        <label class="flex items-center">
                            <input type="checkbox" value="colesterol" class="restriction-checkbox mr-2">
                            <span class="text-sm">Colesterol Alto</span>
                        </label>
                        <label class="flex items-center">
                            <input type="checkbox" value="lactose" class="restriction-checkbox mr-2">
                            <span class="text-sm">Intoler√¢ncia √† Lactose</span>
                        </label>
                        <label class="flex items-center">
                            <input type="checkbox" value="gluten" class="restriction-checkbox mr-2">
                            <span class="text-sm">Intoler√¢ncia ao Gl√∫ten</span>
                        </label>
                        <label class="flex items-center">
                            <input type="checkbox" value="vegetariano" class="restriction-checkbox mr-2">
                            <span class="text-sm">Vegetariano</span>
                        </label>
                    </div>
                </div>
                
                <button type="submit" class="w-full bg-[#608041] hover:bg-[#33160e] text-white font-semibold py-3 px-4 rounded-lg transition duration-300">
                    Salvar e Continuar
                </button>
            </form>
        </div>
    </div>

    <!-- Dashboard Principal -->
    <div id="dashboardScreen" class="min-h-screen bg-gray-50 hidden">
        <!-- Header -->
        <header class="bg-white shadow-sm border-b">
            <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
                <div class="flex justify-between items-center h-16">
                    <div class="flex items-center">
                        <img src="https://i.ibb.co/VW9XDYrJ/logo.png" alt="Viva Sabor" class="h-10 w-auto mr-3">
                        <h1 class="text-xl font-semibold text-gray-800">Viva Sabor</h1>
                    </div>
                    
                    <div class="flex items-center space-x-4">
                        <span id="userPlan" class="px-3 py-1 bg-[#d5cbbf] text-[#33160e] rounded-full text-sm font-medium"></span>
                        <span id="userName" class="text-gray-700 font-medium"></span>
                        <button onclick="logout()" class="text-red-600 hover:text-red-800 font-medium">Sair</button>
                    </div>
                </div>
            </div>
        </header>

        <!-- Navigation -->
        <nav class="bg-white shadow-sm">
            <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
                <div class="flex space-x-8">
                    <button onclick="showSection('dashboard')" class="nav-btn py-4 px-2 border-b-2 border-[#608041] text-[#608041] font-medium">Dashboard</button>
                    <button onclick="showSection('recipes')" class="nav-btn py-4 px-2 border-b-2 border-transparent text-gray-500 hover:text-[#608041]">Receitas</button>
                    <button onclick="showSection('mealPlan')" class="nav-btn py-4 px-2 border-b-2 border-transparent text-gray-500 hover:text-[#608041]">Plano de Refei√ß√µes</button>
                    <button id="consultationsTab" onclick="showSection('consultations')" class="nav-btn py-4 px-2 border-b-2 border-transparent text-gray-500 hover:text-[#608041] hidden">Consultas</button>
                    <button id="videosTab" onclick="showSection('videos')" class="nav-btn py-4 px-2 border-b-2 border-transparent text-gray-500 hover:text-[#608041] hidden">V√≠deo Aulas</button>
                    <button onclick="showSection('profile')" class="nav-btn py-4 px-2 border-b-2 border-transparent text-gray-500 hover:text-[#608041]">Perfil</button>
                    <button id="adminTab" onclick="showSection('admin')" class="nav-btn py-4 px-2 border-b-2 border-transparent text-gray-500 hover:text-[#608041] hidden">Admin</button>
                </div>
            </div>
        </nav>

        <!-- Dashboard Content -->
        <div id="dashboardContent" class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8">
            <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
                <!-- Pr√≥ximas Refei√ß√µes -->
                <div class="bg-white rounded-xl shadow-lg p-6 card-hover">
                    <h3 class="text-lg font-semibold text-gray-800 mb-4">Pr√≥xima Refei√ß√£o</h3>
                    <div id="nextMeal" class="space-y-2">
                        <p class="text-sm text-gray-600">Carregando...</p>
                    </div>
                </div>

                <!-- Pr√≥ximas Consultas (Premium) -->
                <div id="nextConsultationCard" class="bg-white rounded-xl shadow-lg p-6 card-hover hidden">
                    <h3 class="text-lg font-semibold text-gray-800 mb-4">Pr√≥ximas Consultas</h3>
                    <div id="nextConsultations" class="space-y-2">
                        <p class="text-sm text-gray-600">Nenhuma consulta agendada</p>
                    </div>
                </div>

                <!-- Receitas Recomendadas -->
                <div class="bg-white rounded-xl shadow-lg p-6 card-hover">
                    <h3 class="text-lg font-semibold text-gray-800 mb-4">Receitas Recomendadas</h3>
                    <div id="recommendedRecipes" class="space-y-2">
                        <p class="text-sm text-gray-600">Carregando...</p>
                    </div>
                </div>

                <!-- Suporte -->
                <div class="bg-white rounded-xl shadow-lg p-6 card-hover">
                    <h3 class="text-lg font-semibold text-gray-800 mb-4">Suporte</h3>
                    <div class="space-y-3">
                        <a href="mailto:comercialvivasabor@gmail.com" class="block text-[#cb8b32] hover:text-[#33160e] text-sm">
                            üìß E-mail: comercialvivasabor@gmail.com
                        </a>
                        <p class="text-sm text-gray-600">üìû Telefone: (71) 4002-8922</p>
                        <p class="text-sm text-gray-600">üìç Av. Ant√¥nio Carlos Magalh√£es, 1034 - Itaigara, Salvador - BA</p>
                        <div id="chatSupport" class="hidden">
                            <button onclick="openChat()" class="bg-[#608041] hover:bg-[#33160e] text-white px-4 py-2 rounded-lg text-sm">
                                üí¨ Chat Online
                            </button>
                        </div>
                    </div>
                </div>

                <!-- Benef√≠cios Premium -->
                <div id="premiumBenefits" class="bg-white rounded-xl shadow-lg p-6 card-hover hidden">
                    <h3 class="text-lg font-semibold text-gray-800 mb-4">Benef√≠cios Premium</h3>
                    <div class="space-y-3">
                        <div class="flex items-center text-sm text-green-600">
                            <span class="mr-2">‚úÖ</span>
                            <span>R$ 10 de desconto em refei√ß√µes prontas</span>
                        </div>
                        <div class="flex items-center text-sm text-green-600">
                            <span class="mr-2">‚úÖ</span>
                            <span>Consultas com nutricionista</span>
                        </div>
                        <div class="flex items-center text-sm text-green-600">
                            <span class="mr-2">‚úÖ</span>
                            <span>V√≠deo aulas exclusivas</span>
                        </div>
                        <div class="flex items-center text-sm text-green-600">
                            <span class="mr-2">‚úÖ</span>
                            <span>Suporte por chat</span>
                        </div>
                        <button onclick="orderReadyMeals()" class="bg-[#cb8b32] hover:bg-[#33160e] text-white px-4 py-2 rounded-lg text-sm w-full mt-3">
                            üçΩÔ∏è Pedir Refei√ß√µes Prontas
                        </button>
                    </div>
                </div>
            </div>
        </div>

        <!-- Receitas Section -->
        <div id="recipesContent" class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8 hidden">
            <div class="mb-6">
                <h2 class="text-2xl font-bold text-gray-800 mb-4">Receitas Personalizadas</h2>
                
                <!-- Filtros -->
                <div class="bg-white rounded-lg shadow p-4 mb-6">
                    <div class="grid grid-cols-1 md:grid-cols-4 gap-4">
                        <select id="mealTypeFilter" class="px-3 py-2 border border-gray-300 rounded-lg">
                            <option value="">Tipo de Refei√ß√£o</option>
                            <option value="cafe">Caf√© da Manh√£</option>
                            <option value="lanche1">Lanche da Manh√£</option>
                            <option value="almoco">Almo√ßo</option>
                            <option value="lanche2">Lanche da Tarde</option>
                            <option value="jantar">Jantar</option>
                            <option value="ceia">Ceia</option>
                        </select>
                        
                        <select id="difficultyFilter" class="px-3 py-2 border border-gray-300 rounded-lg">
                            <option value="">Dificuldade</option>
                            <option value="facil">F√°cil</option>
                            <option value="medio">M√©dio</option>
                            <option value="dificil">Dif√≠cil</option>
                        </select>
                        
                        <select id="timeFilter" class="px-3 py-2 border border-gray-300 rounded-lg">
                            <option value="">Tempo de Preparo</option>
                            <option value="15">At√© 15 min</option>
                            <option value="30">At√© 30 min</option>
                            <option value="60">At√© 1 hora</option>
                        </select>
                        
                        <button onclick="applyFilters()" class="bg-[#608041] hover:bg-[#33160e] text-white px-4 py-2 rounded-lg">
                            Filtrar
                        </button>
                    </div>
                </div>
                
                <button onclick="updateRestrictions()" class="bg-[#cb8b32] hover:bg-[#33160e] text-white px-4 py-2 rounded-lg mb-4">
                    Alterar Restri√ß√µes Alimentares
                </button>
            </div>
            
            <div id="recipesList" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
                <!-- Receitas ser√£o carregadas aqui -->
            </div>
        </div>

        <!-- Plano de Refei√ß√µes Section -->
        <div id="mealPlanContent" class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8 hidden">
            <div class="mb-6 flex justify-between items-center">
                <h2 class="text-2xl font-bold text-gray-800">Plano de Refei√ß√µes Semanal</h2>
                <button onclick="generateNewMealPlan()" class="bg-[#608041] hover:bg-[#33160e] text-white px-4 py-2 rounded-lg">
                    Gerar Novo Plano
                </button>
            </div>
            
            <div class="bg-white rounded-lg shadow p-4 mb-4">
                <p class="text-sm text-gray-600">√öltima atualiza√ß√£o: <span id="lastUpdate"></span></p>
            </div>
            
            <div id="weeklyMealPlan" class="space-y-6">
                <!-- Plano semanal ser√° carregado aqui -->
            </div>
        </div>

        <!-- Consultas Section (Premium) -->
        <div id="consultationsContent" class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8 hidden">
            <div class="mb-6 flex justify-between items-center">
                <h2 class="text-2xl font-bold text-gray-800">Consultas com Nutricionista</h2>
                <button onclick="scheduleConsultation()" class="bg-[#608041] hover:bg-[#33160e] text-white px-4 py-2 rounded-lg">
                    Agendar Consulta
                </button>
            </div>
            
            <div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
                <div class="bg-white rounded-lg shadow p-6">
                    <h3 class="text-lg font-semibold mb-4">Pr√≥ximas Consultas</h3>
                    <div id="upcomingConsultations">
                        <p class="text-gray-600">Nenhuma consulta agendada</p>
                    </div>
                </div>
                
                <div class="bg-white rounded-lg shadow p-6">
                    <h3 class="text-lg font-semibold mb-4">Hist√≥rico</h3>
                    <div id="consultationHistory">
                        <p class="text-gray-600">Nenhuma consulta realizada</p>
                    </div>
                </div>
            </div>
        </div>

        <!-- V√≠deo Aulas Section (Premium) -->
        <div id="videosContent" class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8 hidden">
            <h2 class="text-2xl font-bold text-gray-800 mb-6">V√≠deo Aulas</h2>
            
            <div id="videosList" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
                <!-- V√≠deos ser√£o carregados aqui -->
            </div>
        </div>

        <!-- Perfil Section -->
        <div id="profileContent" class="max-w-4xl mx-auto px-4 sm:px-6 lg:px-8 py-8 hidden">
            <h2 class="text-2xl font-bold text-gray-800 mb-6">Meu Perfil</h2>
            
            <div class="bg-white rounded-lg shadow p-6">
                <form id="profileForm" class="space-y-6">
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Nome Completo</label>
                            <input type="text" id="profileName" class="w-full px-4 py-3 border border-gray-300 rounded-lg">
                        </div>
                        
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">E-mail</label>
                            <input type="email" id="profileEmail" readonly class="w-full px-4 py-3 border border-gray-300 rounded-lg bg-gray-100">
                        </div>
                        
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Telefone</label>
                            <input type="tel" id="profilePhone" class="w-full px-4 py-3 border border-gray-300 rounded-lg">
                        </div>
                        
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Data de Nascimento</label>
                            <input type="date" id="profileBirthDate" class="w-full px-4 py-3 border border-gray-300 rounded-lg">
                        </div>
                        
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Peso (kg)</label>
                            <input type="number" id="profileWeight" class="w-full px-4 py-3 border border-gray-300 rounded-lg">
                        </div>
                        
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Altura (cm)</label>
                            <input type="number" id="profileHeight" class="w-full px-4 py-3 border border-gray-300 rounded-lg">
                        </div>
                    </div>
                    
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-4">Restri√ß√µes Alimentares</label>
                        <div class="grid grid-cols-2 md:grid-cols-3 gap-3" id="profileRestrictions">
                            <!-- Restri√ß√µes ser√£o carregadas aqui -->
                        </div>
                    </div>
                    
                    <button type="submit" class="bg-[#608041] hover:bg-[#33160e] text-white px-6 py-3 rounded-lg">
                        Salvar Altera√ß√µes
                    </button>
                </form>
            </div>
        </div>

        <!-- Admin Section -->
        <div id="adminContent" class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8 hidden">
            <h2 class="text-2xl font-bold text-gray-800 mb-6">Painel Administrativo</h2>
            
            <div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
                <!-- Gerenciar Usu√°rios -->
                <div class="bg-white rounded-lg shadow p-6">
                    <h3 class="text-lg font-semibold mb-4">Gerenciar Usu√°rios</h3>
                    
                    <div class="mb-4">
                        <input type="email" id="newUserEmail" placeholder="E-mail do usu√°rio" class="w-full px-3 py-2 border border-gray-300 rounded-lg mb-2">
                        <select id="newUserPlan" class="w-full px-3 py-2 border border-gray-300 rounded-lg mb-2">
                            <option value="basico">Plano B√°sico</option>
                            <option value="premium">Plano Premium</option>
                        </select>
                        <button onclick="addUser()" class="bg-green-600 hover:bg-green-700 text-white px-4 py-2 rounded-lg w-full">
                            Adicionar Usu√°rio
                        </button>
                    </div>
                    
                    <div id="usersList" class="space-y-2 max-h-64 overflow-y-auto">
                        <!-- Lista de usu√°rios -->
                    </div>
                </div>
                
                <!-- Personaliza√ß√£o -->
                <div class="bg-white rounded-lg shadow p-6">
                    <h3 class="text-lg font-semibold mb-4">Personaliza√ß√£o</h3>
                    
                    <div class="space-y-4">
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Cor Principal</label>
                            <input type="color" id="primaryColor" value="#2563eb" class="w-full h-10 border border-gray-300 rounded-lg">
                        </div>
                        
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Logo URL</label>
                            <input type="url" id="logoUrl" value="https://i.ibb.co/VW9XDYrJ/logo.png" class="w-full px-3 py-2 border border-gray-300 rounded-lg">
                        </div>
                        
                        <button onclick="updateAppearance()" class="bg-blue-600 hover:bg-blue-700 text-white px-4 py-2 rounded-lg w-full">
                            Aplicar Mudan√ßas
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Modals -->
    
    <!-- Modal Esqueci Senha -->
    <div id="forgotPasswordModal" class="modal">
        <div class="bg-white rounded-lg p-6 w-full max-w-md mx-4">
            <h3 class="text-lg font-semibold mb-4">Recuperar Senha</h3>
            <form id="forgotPasswordForm">
                <div class="mb-4">
                    <label class="block text-sm font-medium text-gray-700 mb-2">E-mail da conta</label>
                    <input type="email" id="forgotEmail" required class="w-full px-3 py-2 border border-gray-300 rounded-lg">
                </div>
                <div class="flex space-x-3">
                    <button type="submit" class="flex-1 bg-blue-600 hover:bg-blue-700 text-white py-2 px-4 rounded-lg">
                        Enviar Senha
                    </button>
                    <button type="button" onclick="closeForgotPassword()" class="flex-1 bg-gray-300 hover:bg-gray-400 text-gray-700 py-2 px-4 rounded-lg">
                        Cancelar
                    </button>
                </div>
            </form>
        </div>
    </div>

    <!-- Modal Ver Receita -->
    <div id="recipeModal" class="modal">
        <div class="bg-white rounded-lg p-6 w-full max-w-2xl mx-4 max-h-[90vh] overflow-y-auto">
            <div class="flex justify-between items-center mb-4">
                <h3 id="recipeTitle" class="text-xl font-semibold"></h3>
                <button onclick="closeRecipeModal()" class="text-gray-500 hover:text-gray-700">‚úï</button>
            </div>
            <div id="recipeContent">
                <!-- Conte√∫do da receita -->
            </div>
        </div>
    </div>

    <!-- Modal Restri√ß√µes -->
    <div id="restrictionsModal" class="modal">
        <div class="bg-white rounded-lg p-6 w-full max-w-md mx-4">
            <h3 class="text-lg font-semibold mb-4">Alterar Restri√ß√µes Alimentares</h3>
            <form id="restrictionsForm">
                <div class="grid grid-cols-1 gap-3 mb-6" id="restrictionsCheckboxes">
                    <!-- Checkboxes de restri√ß√µes -->
                </div>
                <div class="flex space-x-3">
                    <button type="submit" class="flex-1 bg-blue-600 hover:bg-blue-700 text-white py-2 px-4 rounded-lg">
                        Salvar
                    </button>
                    <button type="button" onclick="closeRestrictionsModal()" class="flex-1 bg-gray-300 hover:bg-gray-400 text-gray-700 py-2 px-4 rounded-lg">
                        Cancelar
                    </button>
                </div>
            </form>
        </div>
    </div>

    <!-- Modal Agendar Consulta -->
    <div id="consultationModal" class="modal">
        <div class="bg-white rounded-lg p-6 w-full max-w-md mx-4">
            <h3 class="text-lg font-semibold mb-4">Agendar Consulta</h3>
            <form id="consultationForm">
                <div class="space-y-4">
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">Data</label>
                        <input type="date" id="consultationDate" required class="w-full px-3 py-2 border border-gray-300 rounded-lg">
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">Hor√°rio</label>
                        <select id="consultationTime" required class="w-full px-3 py-2 border border-gray-300 rounded-lg">
                            <option value="">Selecione um hor√°rio</option>
                            <option value="08:00">08:00</option>
                            <option value="09:00">09:00</option>
                            <option value="10:00">10:00</option>
                            <option value="11:00">11:00</option>
                            <option value="14:00">14:00</option>
                            <option value="15:00">15:00</option>
                            <option value="16:00">16:00</option>
                            <option value="17:00">17:00</option>
                        </select>
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">Observa√ß√µes</label>
                        <textarea id="consultationNotes" rows="3" class="w-full px-3 py-2 border border-gray-300 rounded-lg"></textarea>
                    </div>
                </div>
                <div class="flex space-x-3 mt-6">
                    <button type="submit" class="flex-1 bg-blue-600 hover:bg-blue-700 text-white py-2 px-4 rounded-lg">
                        Agendar
                    </button>
                    <button type="button" onclick="closeConsultationModal()" class="flex-1 bg-gray-300 hover:bg-gray-400 text-gray-700 py-2 px-4 rounded-lg">
                        Cancelar
                    </button>
                </div>
            </form>
        </div>
    </div>

    <script>
        // Dados simulados
        let users = {
            'administrador@gmail.com': {
                password: '123456',
                name: 'Administrador',
                plan: 'admin',
                isFirstAccess: false
            },
            'usuario.basico@gmail.com': {
                password: '123456',
                name: 'Maria Silva',
                plan: 'basico',
                isFirstAccess: false,
                phone: '(71) 99999-1234',
                birthDate: '1960-05-15',
                weight: 65,
                height: 160,
                restrictions: ['diabetes', 'hipertensao']
            },
            'usuario.premium@gmail.com': {
                password: '123456',
                name: 'Jo√£o Santos',
                plan: 'premium',
                isFirstAccess: false,
                phone: '(71) 99999-5678',
                birthDate: '1955-08-22',
                weight: 78,
                height: 175,
                restrictions: ['colesterol', 'diabetes']
            }
        };

        let currentUser = null;
        let recipes = [];
        let mealPlans = {};
        let consultations = {};

        // Inicializa√ß√£o
        document.addEventListener('DOMContentLoaded', function() {
            initializeApp();
            generateSampleData();
        });

        function initializeApp() {
            // Event listeners
            document.getElementById('loginForm').addEventListener('submit', handleLogin);
            document.getElementById('firstAccessForm').addEventListener('submit', handleFirstAccess);
            document.getElementById('profileForm').addEventListener('submit', handleProfileUpdate);
            document.getElementById('forgotPasswordForm').addEventListener('submit', handleForgotPassword);
            document.getElementById('restrictionsForm').addEventListener('submit', handleRestrictionsUpdate);
            document.getElementById('consultationForm').addEventListener('submit', handleConsultationSchedule);

            // Definir data m√≠nima para consultas (hoje)
            const today = new Date().toISOString().split('T')[0];
            document.getElementById('consultationDate').min = today;
        }

        function generateSampleData() {
            // IA para gerar receitas baseadas em restri√ß√µes
            generateAIRecipes();
            
            // Gerar plano de refei√ß√µes semanal
            generateWeeklyMealPlan();
        }

        function generateAIRecipes() {
            // Base de receitas expandida com IA simulada
            const recipeDatabase = [
                // Caf√© da Manh√£
                {
                    id: 1,
                    name: 'Omelete de Claras com Espinafre',
                    type: 'cafe',
                    difficulty: 'facil',
                    time: 15,
                    restrictions: ['diabetes', 'hipertensao'],
                    ingredients: ['3 claras de ovo', '1 x√≠cara de espinafre', '1 colher de azeite', 'Sal e pimenta'],
                    instructions: '1. Bata as claras em neve. 2. Refogue o espinafre. 3. Misture tudo e cozinhe por 5 minutos.',
                    calories: 120
                },
                {
                    id: 2,
                    name: 'Mingau de Aveia sem A√ß√∫car',
                    type: 'cafe',
                    difficulty: 'facil',
                    time: 10,
                    restrictions: ['diabetes', 'colesterol'],
                    ingredients: ['1/2 x√≠cara de aveia', '1 x√≠cara de leite desnatado', 'Canela', 'Frutas vermelhas'],
                    instructions: '1. Cozinhe a aveia no leite. 2. Adicione canela. 3. Sirva com frutas vermelhas.',
                    calories: 180
                },
                {
                    id: 3,
                    name: 'Tapioca com Queijo Branco',
                    type: 'cafe',
                    difficulty: 'facil',
                    time: 8,
                    restrictions: ['gluten'],
                    ingredients: ['2 colheres de goma de tapioca', '30g queijo branco', 'Or√©gano'],
                    instructions: '1. Hidrate a tapioca. 2. Fa√ßa a massa na frigideira. 3. Recheie com queijo.',
                    calories: 150
                },
                
                // Lanches
                {
                    id: 4,
                    name: 'Mix de Castanhas',
                    type: 'lanche1',
                    difficulty: 'facil',
                    time: 2,
                    restrictions: ['diabetes', 'vegetariano'],
                    ingredients: ['10 castanhas do par√°', '5 nozes', '10 am√™ndoas'],
                    instructions: '1. Misture todas as castanhas. 2. Consuma com modera√ß√£o.',
                    calories: 200
                },
                {
                    id: 5,
                    name: 'Iogurte Natural com Chia',
                    type: 'lanche2',
                    difficulty: 'facil',
                    time: 5,
                    restrictions: ['diabetes', 'vegetariano'],
                    ingredients: ['1 pote de iogurte natural', '1 colher de chia', 'Frutas vermelhas'],
                    instructions: '1. Misture a chia no iogurte. 2. Deixe descansar 5 min. 3. Adicione frutas.',
                    calories: 120
                },
                
                // Almo√ßo
                {
                    id: 6,
                    name: 'Salada de Quinoa com Legumes',
                    type: 'almoco',
                    difficulty: 'medio',
                    time: 30,
                    restrictions: ['vegetariano', 'gluten'],
                    ingredients: ['1 x√≠cara de quinoa', '2 tomates', '1 pepino', '1 cenoura', 'Azeite e lim√£o'],
                    instructions: '1. Cozinhe a quinoa. 2. Corte os legumes. 3. Misture tudo e tempere.',
                    calories: 280
                },
                {
                    id: 7,
                    name: 'Frango Grelhado com Batata Doce',
                    type: 'almoco',
                    difficulty: 'medio',
                    time: 35,
                    restrictions: ['diabetes', 'hipertensao'],
                    ingredients: ['150g peito de frango', '1 batata doce m√©dia', 'Temperos naturais', 'Salada verde'],
                    instructions: '1. Tempere o frango. 2. Grelhe por 15 min. 3. Asse a batata doce. 4. Sirva com salada.',
                    calories: 350
                },
                
                // Jantar
                {
                    id: 8,
                    name: 'Peixe Grelhado com Br√≥colis',
                    type: 'jantar',
                    difficulty: 'facil',
                    time: 20,
                    restrictions: ['diabetes', 'colesterol'],
                    ingredients: ['1 fil√© de peixe', '1 x√≠cara de br√≥colis', 'Temperos naturais', 'Lim√£o'],
                    instructions: '1. Tempere o peixe. 2. Grelhe por 8 minutos. 3. Cozinhe o br√≥colis no vapor.',
                    calories: 200
                },
                {
                    id: 9,
                    name: 'Sopa de Legumes com Lentilha',
                    type: 'jantar',
                    difficulty: 'medio',
                    time: 40,
                    restrictions: ['vegetariano', 'hipertensao'],
                    ingredients: ['1 x√≠cara de lentilha', 'Cenoura', 'Abobrinha', 'Cebola', 'Temperos naturais'],
                    instructions: '1. Refogue os legumes. 2. Adicione a lentilha e √°gua. 3. Cozinhe por 30 min.',
                    calories: 220
                },
                
                // Ceia
                {
                    id: 10,
                    name: 'Ch√° de Camomila com Biscoito Integral',
                    type: 'ceia',
                    difficulty: 'facil',
                    time: 5,
                    restrictions: ['vegetariano'],
                    ingredients: ['1 sach√™ de ch√° de camomila', '2 biscoitos integrais sem a√ß√∫car'],
                    instructions: '1. Prepare o ch√°. 2. Sirva com os biscoitos.',
                    calories: 80
                }
            ];
            
            recipes = recipeDatabase;
        }

        function generateWeeklyMealPlan() {
            const days = ['Segunda', 'Ter√ßa', 'Quarta', 'Quinta', 'Sexta', 'S√°bado', 'Domingo'];
            const meals = ['Caf√© da Manh√£', 'Lanche da Manh√£', 'Almo√ßo', 'Lanche da Tarde', 'Jantar', 'Ceia'];
            const mealTypes = ['cafe', 'lanche1', 'almoco', 'lanche2', 'jantar', 'ceia'];
            const mealTimes = ['08:00', '10:00', '12:00', '15:00', '19:00', '21:00'];
            
            mealPlans = {};
            const userRestrictions = currentUser ? (currentUser.restrictions || []) : [];
            
            days.forEach((day, dayIndex) => {
                mealPlans[day] = {};
                meals.forEach((meal, mealIndex) => {
                    // Filtrar receitas por tipo de refei√ß√£o e restri√ß√µes do usu√°rio
                    let availableRecipes = recipes.filter(recipe => 
                        recipe.type === mealTypes[mealIndex] &&
                        (userRestrictions.length === 0 || recipe.restrictions.some(r => userRestrictions.includes(r)))
                    );
                    
                    // Se n√£o houver receitas compat√≠veis, usar todas do tipo
                    if (availableRecipes.length === 0) {
                        availableRecipes = recipes.filter(recipe => recipe.type === mealTypes[mealIndex]);
                    }
                    
                    // Garantir que cada dia tenha refei√ß√µes diferentes
                    const recipeIndex = (dayIndex + mealIndex) % availableRecipes.length;
                    const selectedRecipe = availableRecipes[recipeIndex] || recipes[0];
                    
                    mealPlans[day][meal] = {
                        recipe: selectedRecipe,
                        time: mealTimes[mealIndex]
                    };
                });
            });
            
            // Atualizar data da √∫ltima atualiza√ß√£o com hor√°rio brasileiro
            const now = new Date();
            const brazilTime = new Date(now.toLocaleString("en-US", {timeZone: "America/Sao_Paulo"}));
            
            const lastUpdate = document.getElementById('lastUpdate');
            if (lastUpdate) {
                lastUpdate.textContent = brazilTime.toLocaleDateString('pt-BR') + ' √†s ' + brazilTime.toLocaleTimeString('pt-BR', {hour: '2-digit', minute: '2-digit'});
            }
        }

        function handleLogin(e) {
            e.preventDefault();
            
            const email = document.getElementById('loginEmail').value;
            const password = document.getElementById('loginPassword').value;
            
            if (users[email] && users[email].password === password) {
                currentUser = { email, ...users[email] };
                
                if (currentUser.isFirstAccess) {
                    showFirstAccessScreen();
                } else {
                    showDashboard();
                }
            } else {
                alert('E-mail ou senha incorretos!');
            }
        }

        function handleFirstAccess(e) {
            e.preventDefault();
            
            const formData = new FormData(e.target);
            const restrictions = Array.from(document.querySelectorAll('.restriction-checkbox:checked')).map(cb => cb.value);
            
            // Atualizar dados do usu√°rio
            users[currentUser.email] = {
                ...users[currentUser.email],
                name: document.getElementById('fullName').value,
                birthDate: document.getElementById('birthDate').value,
                phone: document.getElementById('phone').value,
                weight: document.getElementById('weight').value,
                height: document.getElementById('height').value,
                password: document.getElementById('newPassword').value,
                restrictions: restrictions,
                isFirstAccess: false
            };
            
            currentUser = { email: currentUser.email, ...users[currentUser.email] };
            showDashboard();
        }

        function showFirstAccessScreen() {
            document.getElementById('loginScreen').classList.add('hidden');
            document.getElementById('firstAccessScreen').classList.remove('hidden');
        }

        function showDashboard() {
            document.getElementById('loginScreen').classList.add('hidden');
            document.getElementById('firstAccessScreen').classList.add('hidden');
            document.getElementById('dashboardScreen').classList.remove('hidden');
            
            // Configurar interface baseada no plano
            setupUserInterface();
            loadDashboardData();
        }

        function setupUserInterface() {
            document.getElementById('userName').textContent = currentUser.name;
            document.getElementById('userPlan').textContent = currentUser.plan === 'admin' ? 'Administrador' : 
                currentUser.plan === 'premium' ? 'Premium' : 'B√°sico';
            
            // Mostrar/ocultar funcionalidades baseadas no plano
            if (currentUser.plan === 'premium') {
                document.getElementById('consultationsTab').classList.remove('hidden');
                document.getElementById('videosTab').classList.remove('hidden');
                document.getElementById('chatSupport').classList.remove('hidden');
                document.getElementById('premiumBenefits').classList.remove('hidden');
            }
            
            if (currentUser.plan === 'admin') {
                document.getElementById('adminTab').classList.remove('hidden');
                document.getElementById('consultationsTab').classList.remove('hidden');
                document.getElementById('videosTab').classList.remove('hidden');
                document.getElementById('chatSupport').classList.remove('hidden');
                document.getElementById('premiumBenefits').classList.remove('hidden');
            }
        }

        function loadDashboardData() {
            // Carregar pr√≥xima refei√ß√£o
            const now = new Date();
            const currentDay = ['Domingo', 'Segunda', 'Ter√ßa', 'Quarta', 'Quinta', 'Sexta', 'S√°bado'][now.getDay()];
            const currentHour = now.getHours();
            
            let nextMeal = null;
            const meals = ['Caf√© da Manh√£', 'Lanche da Manh√£', 'Almo√ßo', 'Lanche da Tarde', 'Jantar', 'Ceia'];
            const mealTimes = [8, 10, 12, 15, 19, 21];
            
            for (let i = 0; i < meals.length; i++) {
                if (currentHour < mealTimes[i]) {
                    nextMeal = {
                        name: meals[i],
                        time: `${mealTimes[i]}:00`,
                        recipe: mealPlans[currentDay][meals[i]].recipe
                    };
                    break;
                }
            }
            
            if (!nextMeal) {
                // Se passou de todas as refei√ß√µes de hoje, mostrar primeira de amanh√£
                const tomorrow = ['Domingo', 'Segunda', 'Ter√ßa', 'Quarta', 'Quinta', 'Sexta', 'S√°bado'][(now.getDay() + 1) % 7];
                nextMeal = {
                    name: meals[0],
                    time: `${mealTimes[0]}:00`,
                    recipe: mealPlans[tomorrow][meals[0]].recipe
                };
            }
            
            document.getElementById('nextMeal').innerHTML = `
                <p class="font-semibold">${nextMeal.name}</p>
                <p class="text-sm text-gray-600">${nextMeal.time}</p>
                <p class="text-sm">${nextMeal.recipe.name}</p>
            `;
            
            // Carregar receitas recomendadas
            const userRestrictions = currentUser.restrictions || [];
            const recommendedRecipes = recipes.filter(recipe => 
                recipe.restrictions.some(r => userRestrictions.includes(r))
            ).slice(0, 3);
            
            document.getElementById('recommendedRecipes').innerHTML = recommendedRecipes.map(recipe => `
                <div class="flex justify-between items-center">
                    <span class="text-sm">${recipe.name}</span>
                    <button onclick="viewRecipe(${recipe.id})" class="text-blue-600 hover:text-blue-800 text-xs">Ver</button>
                </div>
            `).join('');
            
            // Carregar consultas (se premium)
            if (currentUser.plan === 'premium') {
                loadConsultations();
            }
        }

        function showSection(section) {
            // Ocultar todas as se√ß√µes
            const sections = ['dashboardContent', 'recipesContent', 'mealPlanContent', 'consultationsContent', 'videosContent', 'profileContent', 'adminContent'];
            sections.forEach(s => {
                document.getElementById(s).classList.add('hidden');
            });
            
            // Remover classe ativa de todos os bot√µes
            document.querySelectorAll('.nav-btn').forEach(btn => {
                btn.classList.remove('border-blue-500', 'text-blue-600');
                btn.classList.add('border-transparent', 'text-gray-500');
            });
            
            // Mostrar se√ß√£o selecionada
            document.getElementById(section + 'Content').classList.remove('hidden');
            
            // Ativar bot√£o correspondente
            event.target.classList.remove('border-transparent', 'text-gray-500');
            event.target.classList.add('border-blue-500', 'text-blue-600');
            
            // Carregar dados espec√≠ficos da se√ß√£o
            switch(section) {
                case 'recipes':
                    loadRecipes();
                    break;
                case 'mealPlan':
                    loadMealPlan();
                    break;
                case 'consultations':
                    loadConsultations();
                    break;
                case 'videos':
                    loadVideos();
                    break;
                case 'profile':
                    loadProfile();
                    break;
                case 'admin':
                    loadAdmin();
                    break;
            }
        }

        function loadRecipes() {
            const userRestrictions = currentUser.restrictions || [];
            const filteredRecipes = recipes.filter(recipe => 
                userRestrictions.length === 0 || recipe.restrictions.some(r => userRestrictions.includes(r))
            );
            
            document.getElementById('recipesList').innerHTML = filteredRecipes.map(recipe => `
                <div class="bg-white rounded-lg shadow p-6 card-hover">
                    <h3 class="font-semibold text-lg mb-2">${recipe.name}</h3>
                    <div class="text-sm text-gray-600 mb-4">
                        <p>‚è±Ô∏è ${recipe.time} min | üî• ${recipe.calories} cal</p>
                        <p>üìä ${recipe.difficulty === 'facil' ? 'F√°cil' : recipe.difficulty === 'medio' ? 'M√©dio' : 'Dif√≠cil'}</p>
                    </div>
                    <button onclick="viewRecipe(${recipe.id})" class="bg-blue-600 hover:bg-blue-700 text-white px-4 py-2 rounded-lg w-full">
                        Ver Receita Completa
                    </button>
                </div>
            `).join('');
        }

        function loadMealPlan() {
            const days = Object.keys(mealPlans);
            
            document.getElementById('weeklyMealPlan').innerHTML = days.map(day => `
                <div class="bg-white rounded-lg shadow p-6">
                    <h3 class="text-lg font-semibold mb-4">${day}</h3>
                    <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4">
                        ${Object.entries(mealPlans[day]).map(([meal, data]) => `
                            <div class="border rounded-lg p-3">
                                <h4 class="font-medium text-sm mb-1">${meal}</h4>
                                <p class="text-xs text-gray-600 mb-1">${data.time}</p>
                                <p class="text-sm">${data.recipe.name}</p>
                                <button onclick="viewRecipe(${data.recipe.id})" class="text-blue-600 hover:text-blue-800 text-xs mt-1">Ver receita</button>
                            </div>
                        `).join('')}
                    </div>
                </div>
            `).join('');
        }

        function loadConsultations() {
            if (currentUser.plan !== 'premium') return;
            
            const userConsultations = consultations[currentUser.email] || [];
            const upcoming = userConsultations.filter(c => new Date(c.date + ' ' + c.time) > new Date());
            const past = userConsultations.filter(c => new Date(c.date + ' ' + c.time) <= new Date());
            
            document.getElementById('upcomingConsultations').innerHTML = upcoming.length > 0 ? 
                upcoming.map(c => `
                    <div class="border rounded-lg p-3 mb-2">
                        <p class="font-medium">${new Date(c.date).toLocaleDateString('pt-BR')} √†s ${c.time}</p>
                        <p class="text-sm text-gray-600">${c.notes || 'Sem observa√ß√µes'}</p>
                    </div>
                `).join('') : '<p class="text-gray-600">Nenhuma consulta agendada</p>';
            
            document.getElementById('consultationHistory').innerHTML = past.length > 0 ?
                past.map(c => `
                    <div class="border rounded-lg p-3 mb-2">
                        <p class="font-medium">${new Date(c.date).toLocaleDateString('pt-BR')} √†s ${c.time}</p>
                        <p class="text-sm text-gray-600">${c.notes || 'Sem observa√ß√µes'}</p>
                    </div>
                `).join('') : '<p class="text-gray-600">Nenhuma consulta realizada</p>';
            
            // Atualizar card do dashboard se houver consultas
            if (upcoming.length > 0) {
                document.getElementById('nextConsultationCard').classList.remove('hidden');
                document.getElementById('nextConsultations').innerHTML = `
                    <p class="font-semibold">${new Date(upcoming[0].date).toLocaleDateString('pt-BR')}</p>
                    <p class="text-sm text-gray-600">${upcoming[0].time}</p>
                `;
            }
        }

        function loadVideos() {
            if (currentUser.plan !== 'premium') return;
            
            const videos = [
                { id: 1, title: 'Como Preparar Refei√ß√µes Saud√°veis', duration: '15:30' },
                { id: 2, title: 'T√©cnicas de Cozimento para Idosos', duration: '12:45' },
                { id: 3, title: 'Alimenta√ß√£o e Diabetes', duration: '18:20' }
            ];
            
            document.getElementById('videosList').innerHTML = videos.map(video => `
                <div class="bg-white rounded-lg shadow p-6 card-hover">
                    <div class="bg-gray-200 rounded-lg h-32 mb-4 flex items-center justify-center">
                        <span class="text-4xl">üé•</span>
                    </div>
                    <h3 class="font-semibold mb-2">${video.title}</h3>
                    <p class="text-sm text-gray-600 mb-4">‚è±Ô∏è ${video.duration}</p>
                    <button class="bg-red-600 hover:bg-red-700 text-white px-4 py-2 rounded-lg w-full">
                        Assistir
                    </button>
                </div>
            `).join('');
        }

        function loadProfile() {
            document.getElementById('profileName').value = currentUser.name || '';
            document.getElementById('profileEmail').value = currentUser.email || '';
            document.getElementById('profilePhone').value = currentUser.phone || '';
            document.getElementById('profileBirthDate').value = currentUser.birthDate || '';
            document.getElementById('profileWeight').value = currentUser.weight || '';
            document.getElementById('profileHeight').value = currentUser.height || '';
            
            // Carregar restri√ß√µes
            const restrictions = ['diabetes', 'hipertensao', 'colesterol', 'lactose', 'gluten', 'vegetariano'];
            const userRestrictions = currentUser.restrictions || [];
            
            document.getElementById('profileRestrictions').innerHTML = restrictions.map(restriction => `
                <label class="flex items-center">
                    <input type="checkbox" value="${restriction}" ${userRestrictions.includes(restriction) ? 'checked' : ''} class="profile-restriction-checkbox mr-2">
                    <span class="text-sm">${restriction.charAt(0).toUpperCase() + restriction.slice(1)}</span>
                </label>
            `).join('');
        }

        function loadAdmin() {
            if (currentUser.plan !== 'admin') return;
            
            const usersList = Object.entries(users).filter(([email]) => email !== 'administrador@gmail.com');
            
            document.getElementById('usersList').innerHTML = usersList.map(([email, user]) => `
                <div class="flex justify-between items-center p-2 border rounded">
                    <div>
                        <p class="font-medium text-sm">${user.name || email}</p>
                        <p class="text-xs text-gray-600">${user.plan || 'b√°sico'}</p>
                    </div>
                    <div class="flex space-x-2">
                        <button onclick="generateUserPassword('${email}')" class="bg-blue-500 hover:bg-blue-600 text-white px-2 py-1 rounded text-xs">
                            Nova Senha
                        </button>
                        <button onclick="removeUser('${email}')" class="bg-red-500 hover:bg-red-600 text-white px-2 py-1 rounded text-xs">
                            Remover
                        </button>
                    </div>
                </div>
            `).join('');
        }

        function viewRecipe(recipeId) {
            const recipe = recipes.find(r => r.id === recipeId);
            if (!recipe) return;
            
            document.getElementById('recipeTitle').textContent = recipe.name;
            document.getElementById('recipeContent').innerHTML = `
                <div class="space-y-4">
                    <div>
                        <h4 class="font-semibold mb-2">Informa√ß√µes</h4>
                        <p class="text-sm text-gray-600">‚è±Ô∏è Tempo: ${recipe.time} minutos</p>
                        <p class="text-sm text-gray-600">üî• Calorias: ${recipe.calories}</p>
                        <p class="text-sm text-gray-600">üìä Dificuldade: ${recipe.difficulty === 'facil' ? 'F√°cil' : recipe.difficulty === 'medio' ? 'M√©dio' : 'Dif√≠cil'}</p>
                    </div>
                    
                    <div>
                        <h4 class="font-semibold mb-2">Ingredientes</h4>
                        <ul class="list-disc list-inside space-y-1">
                            ${recipe.ingredients.map(ingredient => `<li class="text-sm">${ingredient}</li>`).join('')}
                        </ul>
                    </div>
                    
                    <div>
                        <h4 class="font-semibold mb-2">Modo de Preparo</h4>
                        <p class="text-sm">${recipe.instructions}</p>
                    </div>
                </div>
            `;
            
            document.getElementById('recipeModal').classList.add('show');
        }

        function updateRestrictions() {
            const restrictions = ['diabetes', 'hipertensao', 'colesterol', 'lactose', 'gluten', 'vegetariano'];
            const userRestrictions = currentUser.restrictions || [];
            
            document.getElementById('restrictionsCheckboxes').innerHTML = restrictions.map(restriction => `
                <label class="flex items-center">
                    <input type="checkbox" value="${restriction}" ${userRestrictions.includes(restriction) ? 'checked' : ''} class="restriction-update-checkbox mr-2">
                    <span class="text-sm">${restriction.charAt(0).toUpperCase() + restriction.slice(1)}</span>
                </label>
            `).join('');
            
            document.getElementById('restrictionsModal').classList.add('show');
        }

        function scheduleConsultation() {
            if (currentUser.plan !== 'premium') {
                alert('Funcionalidade dispon√≠vel apenas para usu√°rios Premium');
                return;
            }
            
            document.getElementById('consultationModal').classList.add('show');
        }



        function applyFilters() {
            const mealType = document.getElementById('mealTypeFilter').value;
            const difficulty = document.getElementById('difficultyFilter').value;
            const time = document.getElementById('timeFilter').value;
            
            let filteredRecipes = recipes;
            
            if (mealType) {
                filteredRecipes = filteredRecipes.filter(r => r.type === mealType);
            }
            
            if (difficulty) {
                filteredRecipes = filteredRecipes.filter(r => r.difficulty === difficulty);
            }
            
            if (time) {
                filteredRecipes = filteredRecipes.filter(r => r.time <= parseInt(time));
            }
            
            // Aplicar restri√ß√µes do usu√°rio
            const userRestrictions = currentUser.restrictions || [];
            if (userRestrictions.length > 0) {
                filteredRecipes = filteredRecipes.filter(recipe => 
                    recipe.restrictions.some(r => userRestrictions.includes(r))
                );
            }
            
            document.getElementById('recipesList').innerHTML = filteredRecipes.map(recipe => `
                <div class="bg-white rounded-lg shadow p-6 card-hover">
                    <h3 class="font-semibold text-lg mb-2">${recipe.name}</h3>
                    <div class="text-sm text-gray-600 mb-4">
                        <p>‚è±Ô∏è ${recipe.time} min | üî• ${recipe.calories} cal</p>
                        <p>üìä ${recipe.difficulty === 'facil' ? 'F√°cil' : recipe.difficulty === 'medio' ? 'M√©dio' : 'Dif√≠cil'}</p>
                    </div>
                    <button onclick="viewRecipe(${recipe.id})" class="bg-blue-600 hover:bg-blue-700 text-white px-4 py-2 rounded-lg w-full">
                        Ver Receita Completa
                    </button>
                </div>
            `).join('');
        }

        function addUser() {
            const email = document.getElementById('newUserEmail').value;
            const plan = document.getElementById('newUserPlan').value;
            
            if (!email) {
                alert('Por favor, insira um e-mail v√°lido');
                return;
            }
            
            if (users[email]) {
                alert('Usu√°rio j√° existe');
                return;
            }
            
            // Gerar senha tempor√°ria
            const tempPassword = Math.floor(100000 + Math.random() * 900000).toString();
            
            users[email] = {
                password: tempPassword,
                plan: plan,
                isFirstAccess: true
            };
            
            alert(`Usu√°rio adicionado com sucesso!\nSenha tempor√°ria: ${tempPassword}`);
            
            document.getElementById('newUserEmail').value = '';
            loadAdmin();
        }

        function removeUser(email) {
            if (confirm(`Tem certeza que deseja remover o usu√°rio ${email}?`)) {
                delete users[email];
                if (consultations[email]) {
                    delete consultations[email];
                }
                loadAdmin();
                alert('Usu√°rio removido com sucesso!');
            }
        }

        function generateUserPassword(email) {
            const newPassword = Math.floor(100000 + Math.random() * 900000).toString();
            users[email].password = newPassword;
            users[email].isFirstAccess = true;
            
            alert(`Nova senha gerada para ${email}: ${newPassword}`);
        }

        function updateAppearance() {
            const primaryColor = document.getElementById('primaryColor').value;
            const logoUrl = document.getElementById('logoUrl').value;
            
            // Aplicar mudan√ßas (simulado)
            document.documentElement.style.setProperty('--primary-color', primaryColor);
            
            const logos = document.querySelectorAll('img[alt="Viva Sabor"]');
            logos.forEach(logo => logo.src = logoUrl);
            
            alert('Apar√™ncia atualizada com sucesso!');
        }

        function openChat() {
            if (currentUser.plan === 'premium' || currentUser.plan === 'admin') {
                alert('üí¨ Chat de suporte iniciado!\n\nOl√°! Como posso ajud√°-lo hoje?\n\n‚Ä¢ D√∫vidas sobre receitas\n‚Ä¢ Problemas t√©cnicos\n‚Ä¢ Sugest√µes de melhorias\n\n(Funcionalidade simulada - Em breve chat real!)');
            } else {
                alert('Funcionalidade dispon√≠vel apenas para usu√°rios Premium');
            }
        }

        function orderReadyMeals() {
            if (currentUser.plan === 'premium' || currentUser.plan === 'admin') {
                const discount = currentUser.plan === 'premium' ? 10 : 0;
                alert(`üçΩÔ∏è Pedido de Refei√ß√µes Prontas\n\nRefei√ß√µes dispon√≠veis:\n‚Ä¢ Almo√ßo Saud√°vel - R$ ${35 - discount}\n‚Ä¢ Jantar Light - R$ ${30 - discount}\n‚Ä¢ Kit Semanal - R$ ${180 - (discount * 7)}\n\n${discount > 0 ? `‚úÖ Desconto Premium aplicado: R$ ${discount}` : ''}\n\n(Funcionalidade simulada - Em breve pedidos reais!)`);
            } else {
                alert('Funcionalidade dispon√≠vel apenas para usu√°rios Premium');
            }
        }

        function generateNewMealPlan() {
            // Simular gera√ß√£o de novo plano com IA baseada em restri√ß√µes
            const userRestrictions = currentUser.restrictions || [];
            
            // Mostrar loading
            const button = event.target;
            const originalText = button.textContent;
            button.textContent = 'Gerando...';
            button.disabled = true;
            
            setTimeout(() => {
                generateWeeklyMealPlan();
                loadMealPlan();
                
                button.textContent = originalText;
                button.disabled = false;
                
                const restrictionsText = userRestrictions.length > 0 ? 
                    `\nRestri√ß√µes consideradas: ${userRestrictions.join(', ')}` : 
                    '\nNenhuma restri√ß√£o espec√≠fica';
                
                alert(`ü§ñ IA Viva Sabor\n\nNovo plano de refei√ß√µes gerado com sucesso!${restrictionsText}\n\nTodas as receitas foram personalizadas para suas necessidades nutricionais.`);
            }, 2000);
        }

        // Event handlers para modais e formul√°rios
        function handleForgotPassword(e) {
            e.preventDefault();
            const email = document.getElementById('forgotEmail').value;
            
            if (users[email]) {
                const tempPassword = Math.floor(100000 + Math.random() * 900000).toString();
                users[email].password = tempPassword;
                users[email].isFirstAccess = true;
                
                alert(`Senha tempor√°ria enviada para ${email}: ${tempPassword}`);
                closeForgotPassword();
            } else {
                alert('E-mail n√£o encontrado!');
            }
        }

        function handleProfileUpdate(e) {
            e.preventDefault();
            
            const restrictions = Array.from(document.querySelectorAll('.profile-restriction-checkbox:checked')).map(cb => cb.value);
            
            users[currentUser.email] = {
                ...users[currentUser.email],
                name: document.getElementById('profileName').value,
                phone: document.getElementById('profilePhone').value,
                birthDate: document.getElementById('profileBirthDate').value,
                weight: document.getElementById('profileWeight').value,
                height: document.getElementById('profileHeight').value,
                restrictions: restrictions
            };
            
            currentUser = { email: currentUser.email, ...users[currentUser.email] };
            
            alert('Perfil atualizado com sucesso!');
            setupUserInterface();
        }

        function handleRestrictionsUpdate(e) {
            e.preventDefault();
            
            const restrictions = Array.from(document.querySelectorAll('.restriction-update-checkbox:checked')).map(cb => cb.value);
            
            users[currentUser.email].restrictions = restrictions;
            currentUser.restrictions = restrictions;
            
            closeRestrictionsModal();
            loadRecipes();
            loadDashboardData();
            
            alert('Restri√ß√µes atualizadas! As receitas foram atualizadas.');
        }

        function handleConsultationSchedule(e) {
            e.preventDefault();
            
            const date = document.getElementById('consultationDate').value;
            const time = document.getElementById('consultationTime').value;
            const notes = document.getElementById('consultationNotes').value;
            
            if (!consultations[currentUser.email]) {
                consultations[currentUser.email] = [];
            }
            
            consultations[currentUser.email].push({
                date: date,
                time: time,
                notes: notes,
                status: 'agendada'
            });
            
            closeConsultationModal();
            loadConsultations();
            
            alert('Consulta agendada com sucesso!');
        }

        // Fun√ß√µes para controle de modais
        function showForgotPassword() {
            document.getElementById('forgotPasswordModal').classList.add('show');
        }

        function closeForgotPassword() {
            document.getElementById('forgotPasswordModal').classList.remove('show');
            document.getElementById('forgotEmail').value = '';
        }

        function closeRecipeModal() {
            document.getElementById('recipeModal').classList.remove('show');
        }

        function closeRestrictionsModal() {
            document.getElementById('restrictionsModal').classList.remove('show');
        }

        function closeConsultationModal() {
            document.getElementById('consultationModal').classList.remove('show');
            document.getElementById('consultationForm').reset();
        }

        function logout() {
            if (confirm('Tem certeza que deseja sair?')) {
                currentUser = null;
                document.getElementById('dashboardScreen').classList.add('hidden');
                document.getElementById('loginScreen').classList.remove('hidden');
                document.getElementById('loginForm').reset();
            }
        }

        // Fechar modais clicando fora
        window.onclick = function(event) {
            const modals = document.querySelectorAll('.modal');
            modals.forEach(modal => {
                if (event.target === modal) {
                    modal.classList.remove('show');
                }
            });
        }
    </script>
<script>(function(){function c(){var b=a.contentDocument||a.contentWindow.document;if(b){var d=b.createElement('script');d.innerHTML="window.__CF$cv$params={r:'96f91587c377fd72',t:'MTc1NTI2NTAyMC4wMDAwMDA='};var a=document.createElement('script');a.nonce='';a.src='/cdn-cgi/challenge-platform/scripts/jsd/main.js';document.getElementsByTagName('head')[0].appendChild(a);";b.getElementsByTagName('head')[0].appendChild(d)}}if(document.body){var a=document.createElement('iframe');a.height=1;a.width=1;a.style.position='absolute';a.style.top=0;a.style.left=0;a.style.border='none';a.style.visibility='hidden';document.body.appendChild(a);if('loading'!==document.readyState)c();else if(window.addEventListener)document.addEventListener('DOMContentLoaded',c);else{var e=document.onreadystatechange||function(){};document.onreadystatechange=function(b){e(b);'loading'!==document.readyState&&(document.onreadystatechange=e,c())}}}})();</script></body>
</html>
